<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>시:그널 - 민원 목록</title>
    <link rel="stylesheet" th:href="@{/css/style.css}">
</head>

<body>

<div th:replace="layout/header :: header"></div>

<main class="container container-narrow">

    <section class="top3-section" th:if="${top3 != null and !#lists.isEmpty(top3)}">
        <div class="section-title">
            <span>🏆 지금 핫한 민원</span>
            <span class="section-note">공감이 가장 많은 민원입니다.</span>
        </div>

        <div class="top3-grid">
            <a th:each="c : ${top3}" th:href="@{'/complaints/detail/' + ${c.id}}" class="card card-highlight">
                <div class="card-top">
                    <span class="badge badge-cat" th:text="${c.category}">카테고리</span>
                    <span class="badge badge-like">♥ <span th:text="${c.likes}">0</span></span>
                </div>

                <div class="card-title" th:text="${c.title}">제목</div>
                <div class="card-info" th:text="${c.location}">위치</div>
            </a>
        </div>
    </section>

    <div class="filter-bar">
        <form method="get" action="/complaints/list" class="filter-form">
            <select name="category" class="select">
                <option value="">전체 카테고리</option>
                <option value="도로">🚧 도로/시설</option>
                <option value="교통">🚌 교통</option>
                <option value="환경">🌳 환경/청소</option>
                <option value="안전">👮 안전</option>
                <option value="기타">📝 기타</option>
            </select>

            <select name="sort" class="select">
                <option value="latest">최신순</option>
                <option value="likes">공감순</option>
                <option value="status">처리상태순</option>
            </select>

            <button type="submit" class="btn btn-ghost">검색</button>
        </form>

        <a href="/complaints/new" class="btn btn-primary">✏️ 민원 작성하기</a>
    </div>

    <div class="card-list">

        <div th:if="${#lists.isEmpty(complaints)}" class="empty-state">
            <div class="empty-icon">📭</div>
            <p>등록된 민원이 없거나 검색 결과가 없습니다.</p>
        </div>

        <a th:each="c : ${complaints}" th:href="@{'/complaints/detail/' + ${c.id}}" class="card card-row">

            <div class="card-row-inner">
                <div class="card-row-main">
                    <div class="meta-line">
                        <span class="badge status"
                              th:classappend="${c.status == '접수'} ? ' status-received' : (${c.status == '처리중'} ? ' status-progress' : ' status-done')"
                              th:text="${c.status}">상태</span>

                        <span class="section-note" th:text="${c.category}">카테고리</span>
                    </div>

                    <h3 class="card-title" th:text="${c.title}">민원 제목</h3>

                    <div class="card-info">
                        📍 <span th:text="${c.location}">위치</span>
                        <span class="section-note">|</span>
                        <span th:text="${#temporals.format(c.createdAt, 'yyyy-MM-dd')}">2025-12-14</span>
                    </div>
                </div>

                <div class="card-row-meta">
                    <div class="meta-label">공감</div>
                    <div class="meta-like">♥ <span th:text="${c.likes}">0</span></div>
                </div>
            </div>

        </a>

    </div>
</main>

</body>
</html>
